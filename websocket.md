
<!-- 传统http请求存在的缺陷 -->
在浏览器和服务器通信间，传统http请求在实时性场景下的表现并不是很理想，主要是因为它无法做到消息的实时性以及服务端无法主动推送信息。
而基于http的主要解决方案有：
  1. 基于ajax的轮询：客户端定时向服务端请求接口，询问服务端是否有新信息。（缺点：多余的空请求造成的资源浪费，数据获取有延时）
  2. Long Poll：采用阻塞性方案，客户端向服务端发起ajax 请求，服务端挂起该请求不返回数据直到有新的数据，客户端接收到数据之后再次执行Long Poll。（缺点：每个请求都挂起了服务器资源，在大量连接的场景下是不可接受的）
所以，基于http协议的方案都包含一个本质缺陷--被动性。服务端无法下推消息，仅能由客户端发起请求不断询问是否有新的消息，同时对于客户端和服务端都存在性能消耗

<!-- websocket  -->
websocket 是h5 提供的一种浏览器与服务器进行全双工通讯的网络技术（即支持双向通信），属于应用层协议。它基于TCP传输协议，并复用Http的握手通道。
在websocket API中，浏览器和服务器只需要做一个握手的动作，二者之间就形成了一条快速通道，之后便可直接进行数据传递了。
websocket 特点：
  1. 建立于TCP协议之上的应用层
  2. 一旦建立连接（直到断开或出错），服务端与客户端握手后则一直保持连接状态，是持久连接
  3. 服务端可通过实时通道主动发消息
  4. 数据接收的实时性（相对）与时序性

<!-- websocket 心跳机制： -->
websocket 定义了心跳机制，一方发送ping消息给另一方，另一方收到ping后应该尽可能的返回pong。
心跳机制用于检测连接的对方在线状态，如果没有心跳，则无法判断一方是否还在连接状态，一些网络层（比如：nginx或浏览器）会主动断开连接。
在js中，websokcet没有开发ping/pong 的api，不同浏览器对心跳的处理实现也不同，因此需要在开发时与服务端约定好自己实现一个心跳机制（例如浏览器中，检测到open事件后，启动一个定时任务，每次发送数据 0x9 给服务端,而服务端返回0xA 作为响应）
通过实践，心跳的定时任务一般是相隔15-20秒发送一次

<!-- websocket 与 http 的联系 -->
websocket 连接分为建连阶段和连接阶段。在建立连接阶段借助于http，而在连接阶段则与http无关。

<!-- websocket如何兼容低版本浏览器？ -->
Adobe Flash Socket；
ActiveX HTMLFile (IE) ；
基于 multipart 编码发送 XHR；
基于长轮询的 XHR；